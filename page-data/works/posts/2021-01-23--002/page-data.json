{"componentChunkName":"component---src-templates-post-template-jsx","path":"/works/posts/2021-01-23--002","result":{"data":{"site":{"siteMetadata":{"title":"Blog by Eunyoung","subtitle":"EY's 개발 히스토리 블로그","copyright":"© All rights reserved.","author":{"name":"EunYoung","twitter":"#"},"disqusShortname":"","url":"https://eunyoung-autocrypt.github.io"}},"markdownRemark":{"id":"400eaa38-ea31-5f1a-835e-9680eeac6f9c","html":"<p><span class=\"title__sub1\"> Sonarqube ? </span></p>\n<ul>\n<li>20개 이상의 프로그래밍 언어에서 버그, 코드 스멜, 보안 취약점을 발견할 목적으로 정적 코드 분석으로 자동 리뷰를 수행하기 위한 지속적인 코드 품질 검사용 오픈 소스 플랫폼 </li>\n<li>중복 코드, 코딩 표준, 유닛 테스트, 코드 커버리지, 코드 복잡도, 주석, 버그 및 보안 취약점의 보고서를 제공.</li>\n<li>sonar scanner에게 정적 분석 관련 데이터 제공</li>\n</ul>\n<br>\n<p><span class=\"title__sub1\"> 정적분석을 위한 Sonarqube 설치 </span></p>\n<ul>\n<li><a href=\"https://hub.docker.com/_/sonarqube/\">https://hub.docker.com/_/sonarqube/</a></li>\n</ul>\n<p><span class=\"title__sub2\">1. host 설정</span></p>\n<ul>\n<li>sonarqube 내부에 Elasticsearch 를 사용하고 있기 때문에 필요 설정이 있다\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/7a24aa1ce8afd1f2e94e6157c789e279/e619b/002-01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 787px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 38.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABCklEQVQoz5VRa2+DMAzk///ESVM3Op4ZeSdASXqzA3T9MGkq4rBzwedzUgmp8V43uHYD6rbH2+WKj6bD5atDO3zj1aeK8wJjHazzBYagaS21Kfm8LFjWdceyR+YYgWp9nMEa4YiV9QGj9hAmQBxxsgG9tBiUwyANhDKP9agd2slAuVjEWZRjpAZF0IWITkgIKpy0xUhHII2Dsr6Ac+Y51wwXiOPo4amW6w3xbKyMzFYVFZxj85jM5ZyxbYmwHaA8pYPb+duJ246c76h401LX/SzJkbKYaERJTXgvkUjanoV+kU48/VMcfjZ9udG6GYrYOCnM8/ro/Aoq/rBDHtX5CNzpJesp5T9d/YcfNlRsle3zlIQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"002 01\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/7a24aa1ce8afd1f2e94e6157c789e279/e619b/002-01.png\"\n        srcset=\"/devHistoryBlog/static/7a24aa1ce8afd1f2e94e6157c789e279/8ff5a/002-01.png 240w,\n/devHistoryBlog/static/7a24aa1ce8afd1f2e94e6157c789e279/e85cb/002-01.png 480w,\n/devHistoryBlog/static/7a24aa1ce8afd1f2e94e6157c789e279/e619b/002-01.png 787w\"\n        sizes=\"(max-width: 787px) 100vw, 787px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># max_map_count ?\nThis file contains the maximum number of memory map areas a process may have. Memory map areas are used as a side-effect of calling malloc, directly by mmap and mprotect, and also when loading shared libraries.\nWhile most applications need less than a thousand maps, certain programs, particularly malloc debuggers, may consume lots of them, e.g., up to one or two maps per allocation.\nThe default value is 65536.</code></pre></div>\n<br>\n<p><span class=\"title__sub2\">2. DB 및 Volumes 설정 내용 </span>\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/5ab97f9516fe199f8f2313f58a223c46/0f67e/002-02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 921px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 58.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABV0lEQVQoz5VTi26EIBD0/3+yTWpPqyCC+EDU7c4qV03tJSWZDCy4O/swe/t40HteUN0YwlrXldZto+0Gf9nPyIpKUZgj/We9dAhlne/JMfphJNf1ZDsvZ7Bnm+8H6hg4n4NvN0EybSxBpTLtjqYl2GrmprUMR7q1UhLcGeuodZ0w3oHlHTPKlcHw+FLiFPxZVsy1nIGy1vQAq4YK3ucl3ylDed1SqS0rH0X9OIVdYVLkh0FSR4pIN6UpZcBHYxDYYWIEcuPM55n8FCnE9Zl2huhIKS6LYAHHfT/HKI9edEcqeWkK1KAmcHqujYBtUCgB4h4ghJmmECTgbZcdd65SWqCPpqA5cAanaZ+Kr7g5tTZSkrsRyiyrQuGl0/w4qWxOSo3tpOtJfeo8soPSy9jAqI6RgEJ8lOYwOQdPnOqvP4fHJNX4ModQCBXAjxN/pOmeQcBnRXd/zjerVKLxZBShkQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"002 02\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/5ab97f9516fe199f8f2313f58a223c46/0f67e/002-02.png\"\n        srcset=\"/devHistoryBlog/static/5ab97f9516fe199f8f2313f58a223c46/8ff5a/002-02.png 240w,\n/devHistoryBlog/static/5ab97f9516fe199f8f2313f58a223c46/e85cb/002-02.png 480w,\n/devHistoryBlog/static/5ab97f9516fe199f8f2313f58a223c46/0f67e/002-02.png 921w\"\n        sizes=\"(max-width: 921px) 100vw, 921px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<br>\n<p><span class=\"title__sub2\">3. Compose 파일 작성</span></p>\n<ul>\n<li>sonarqube develop edition 버전 설치 (trial 라이센스 문의 함)</li>\n<li>embedded db : postgres 사용</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">version: &quot;3.7&quot;\nservices:\n  db:\n    image: postgres\n    container_name: sonar-postgres\n    restart: always\n    environment:\n      POSTGRES_USER: sonar\n      PASTGRES_PASSWORD: sonar\n      TZ: Asia/Seoul\n      POSTGRES_HOST_AUTH_METHOD: trust\n    volumes:\n      - ~/docker-volumes/sonar-postgres/postgres:/var/lib/postgresql/data\n  \n  sonarqube:\n    image: sonarqube:8.6.1-developer\n    container_name: sonarqube\n    restart: always\n    environment:\n      SONARQUBE_HOME: ./\n      SONARQUBE_JDBC_USERNAME: sonar\n      SONARQUBE_JDBC_PASSWORD: sonar\n      SONARQUBE_JDBC_URL: jdbc:postgresql://db:5432/sonar\n    depends_on:\n      - db\n    ports:\n      - 10002:9000\n    volumes:\n      - ~/docker-volumes/sonar-postgres/sonarqube/data:/opt/sonarqube/data\n      - ~/docker-volumes/sonar-postgres/sonarqube/extensions:/opt/sonarqube/extensions\n      - ~/docker-volumes/sonar-postgres/sonarqube/logs:/opt/sonarqube/logs\n      - ~/docker-volumes/sonar-postgres/temp:/opt/sonarqube/temp</code></pre></div>\n<br>\n<p><span class=\"title__sub2\">4. 서비스 기동</span></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker-compose -f sonarqube-compose.yml up -d</code></pre></div>\n<br>\n<p><span class=\"title__sub1\"> 정적분석을 위한 Sonarqube 프로젝트 생성 및</span> </p>\n<p><span class=\"title__sub2\">1. Sonarqube 프로젝트 생성</span></p>\n<ul>\n<li>10002 포트로 접속 후 로그인 &#x26; 프로젝트 생성\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/1ec4e0187cad189410f134a4520be1a9/eea79/002-05.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 502px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 77.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABJ0AAASdAHeZh94AAAB6ElEQVQ4y5WUbZObIBSF/f//bD90djbJRI0ajFZQUUHwLW1nToGdtXWTdNMPj/eKzOHAvehRSnE+nx2EENj3NE1dnsQxOOcYhgFKKWitv8QrigK+7+NwOCAIAifsBz72+51hvxF8Bs9OnqZpZRzHNZ/n2a36rNgqaEVstNwTuLe1R9+8PMvw9rZDYLZN4gRVVaHve6hePcR+n4cZk55uHbKO4pRFSAuCSlRQV7P6YlY28R7qqjD/nHFsjiAtwTItq2Pn0AomNAGhZ+R1jlKWqPoaTDBHKcr3MVm5SAUFlxw7ukPCE3RNByHEKuoxxhAnsSFBekldHsWRqbiPxFQ8iiKcopMbD0+h6Yiji3maO86mvZqm+eOw4Q0YZeA1R9u0ZsXWRSkktNLoZe/yj/ieK3SiQ81rI6Q3fepdshSvu1cEcYhjeDQuCXjH0Q89hBKQWt5gx127jdOm2m7LpaQIv59AGEE7ddC/jKurcbPIu4hFYPox4YW94FAdsAzLRtQreYmMZsiKDDnLHVVbQw7yrjuLdW8LZosz6O219OyZKGkmmWjPrjFX7aNq9gwfMerxRswJ0rrFt/CC4MIgTNOO41+3Rf+DT2e3Clamj4LU/HGKCsJUUuvtxGf/MqvgYB7zOGyc/Y/AZ34D8OO59yenUa8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"002 05\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/1ec4e0187cad189410f134a4520be1a9/eea79/002-05.png\"\n        srcset=\"/devHistoryBlog/static/1ec4e0187cad189410f134a4520be1a9/8ff5a/002-05.png 240w,\n/devHistoryBlog/static/1ec4e0187cad189410f134a4520be1a9/e85cb/002-05.png 480w,\n/devHistoryBlog/static/1ec4e0187cad189410f134a4520be1a9/eea79/002-05.png 502w\"\n        sizes=\"(max-width: 502px) 100vw, 502px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \n<br></li>\n<li>프로젝트 토큰 생성\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/dcd094aa105fa8673ecc2a2b2322129a/e619b/002-06.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 787px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 32.08333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABJ0AAASdAHeZh94AAAAz0lEQVQY06WRyW5CMQxF3///HktWSAgKL2Qg03OmWzutoCp0VUsnthzlesiyO1ywGoecEkKMICL03tFae6G+yf1m2Z81VusR/B3OOUQW/Y8tcsStYL0Z2LuHjwlUpZuB0vqDkAnGJxS+ExtjvGVhkKngqjSsD0gck4j0MakTwIQNR+W4WP+zuykogczuQ4AxBlpr5JxRawWVMndKXKRyPHpDYV++8z9j0XiOzHtTSsGyoLUWH9ztadVcJLJ4mh+WmLxtX54LyhvxguREVDr8BKtY1eONlFIfAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"002 06\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/dcd094aa105fa8673ecc2a2b2322129a/e619b/002-06.png\"\n        srcset=\"/devHistoryBlog/static/dcd094aa105fa8673ecc2a2b2322129a/8ff5a/002-06.png 240w,\n/devHistoryBlog/static/dcd094aa105fa8673ecc2a2b2322129a/e85cb/002-06.png 480w,\n/devHistoryBlog/static/dcd094aa105fa8673ecc2a2b2322129a/e619b/002-06.png 787w\"\n        sizes=\"(max-width: 787px) 100vw, 787px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \n<br></li>\n<li>을 하면 아래와 같이 sonar scanner 를 사용하기 위한 설정 방법이 나온다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/bf81404469ad3593a0cd1a85abd3233d/c65fa/002-04.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 40.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA8klEQVQY042QzW7DIBCE/f7v1KOlRrJ6TJW2ruNgwIB/wCyODcEUmktSNWo/rdBIq2FGmwHAPM+rtSEE/4DNb4tbzNkIIcqyrKrqsywppRnp1WzALrMxsIUtpAnbb6RftrS9EnVmrfto2NPLe9uNyixxRn22zod/kHl/kZMWo5o0qGnSGpy7pKb+mvQz8M5s1/VU16SJoAYhSkkboS3BmBASBcaYMdbfMPQ946IfZOac67qOcx5fKWVMNt/EK94KuCd2BDDJTAlBCLWMdUIMwxB3+i+kUhogmevj8XB4K4oiz/Pn3W6/f43F2WM4Zw0mLRdfL73GsvdEufYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"002 04\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/bf81404469ad3593a0cd1a85abd3233d/d9199/002-04.png\"\n        srcset=\"/devHistoryBlog/static/bf81404469ad3593a0cd1a85abd3233d/8ff5a/002-04.png 240w,\n/devHistoryBlog/static/bf81404469ad3593a0cd1a85abd3233d/e85cb/002-04.png 480w,\n/devHistoryBlog/static/bf81404469ad3593a0cd1a85abd3233d/d9199/002-04.png 960w,\n/devHistoryBlog/static/bf81404469ad3593a0cd1a85abd3233d/c65fa/002-04.png 1434w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n</ul>\n<br>\n<p><span class=\"title__sub2\">2. Scanner 설정 및 실행</span></p>\n<ul>\n<li>build.gradle에 plugin 추가 후</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">plugins <span class=\"token punctuation\">{</span>\n  id <span class=\"token string\">\"org.sonarqube\"</span> version <span class=\"token string\">\"3.0\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>scanner 를 실행하면</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./gradlew sonarqube \\\n  -Dsonar.projectKey=Test-Proj \\\n  -Dsonar.host.url=http://HOST:10002 \\\n  -Dsonar.login=***********************</code></pre></div>\n<ul>\n<li>정적분석 결과가 표시된다.</li>\n</ul>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/3adf418ed240c4d33879ddf364d05ad9/951a4/002-07.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABvUlEQVQoz41STWsUQRDtS8457D/Ir9Fr/I0eJGZRUE+CgseEQE4RJEpIYGMYnOmP6u+eZ1XvLLokiM0UNXRXv3rvVavgMpJOaH7G7AFk/lJCzvyDmT/en5sk1Dgh0gOcHRCjh/cexhho6zAZh1IK1Mfrzzj5+hqn306x/r7Ghx/vcbe5wzSOXGgxjAYjFxtjYfmidQTnHIO6LZjW0JL7uYV68eUYq7crqFcK6qXC6s0KN8MNrCGEGEDMotTKjCJCCHshexLCNDjDgAbq2afnHexwfYiDkwMcvTvCTxrgQ+lS/2eJ1OonkABePVzhbHOGi80FzjfnuLy/REjcOeXu49w9/HfU1pDZAseyVXQRhQoy5SUSEgOFmFBZqqzdxdbaIzAs+6X7yoDaiKn7EXjKFMSfsEy7oyKx+eKdSNw1auIv19fJgvhcyWR2YZZJiVzjY2f4NxtN2yHUUvZYJ6mPGsY9CWg6oPWps1rI9TUx4NaKP8MS0JILxjg+BWhgOOcUMFmN20Gz9ISZWVgfFggC8Su4/+W6AmmuaXtGRI8Bu2T2zge+6CXH7qNILaWhZkIM3MjH7l3i8FxXaukP/jdVN0DhWZ2OGwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"002 07\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/3adf418ed240c4d33879ddf364d05ad9/d9199/002-07.png\"\n        srcset=\"/devHistoryBlog/static/3adf418ed240c4d33879ddf364d05ad9/8ff5a/002-07.png 240w,\n/devHistoryBlog/static/3adf418ed240c4d33879ddf364d05ad9/e85cb/002-07.png 480w,\n/devHistoryBlog/static/3adf418ed240c4d33879ddf364d05ad9/d9199/002-07.png 960w,\n/devHistoryBlog/static/3adf418ed240c4d33879ddf364d05ad9/951a4/002-07.png 1355w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<br>\n<p><span class=\"title__sub1\">Pipeline 작성</span>\n<span class=\"title__sub2\">1. Test Stage</span></p>\n<ul>\n<li>테스트 코드를 수행한다.</li>\n<li>테스트 실패 시 테스트 결과 게시 및 PR comment &#x26; decline api 전송 후 파이프라인을 종료한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">stage (&#39;Test&#39;) {\n    sh &#39;&#39;&#39;\n    {\n        ./gradlew test \\\n        &amp;&amp; curl -X POST -u &quot;$USER&quot; $COMMENT_URL -d &#39;{&quot;content&quot;: {&quot;raw&quot;: &quot;[TEST] SUCCESS&quot;}}&#39; -H &#39;Content-Type: application/json&#39; &gt; /dev/null 2&gt;&amp;1 \\\n        &amp;&amp; echo [TEST] SUCCESS;\n    }||\\\n    {\n        ssh -ir ~/.ssh/v2g_srv $V2G_DEV_SERVER bash -c &quot;&#39;mkdir -p /docker-volumes/nginx/html/failed-test/$SOURCE_BRANCH&#39;&quot;;\n        scp -ir ~/.ssh/v2g_srv ./build/reports/tests/test $V2G_DEV_SERVER:/docker-volumes/nginx/html/failed-test/$SOURCE_BRANCH;\n        curl -X POST -u &quot;$USER&quot; $COMMENT_URL -d &#39;{&quot;content&quot;: {&quot;raw&quot;: &quot;[TEST] FAIL&quot;}}&#39; -H &#39;Content-Type: application/json&#39; &gt; /dev/null 2&gt;&amp;1;\n        curl -X POST -u &quot;$USER&quot; $DECLINE_URL -d &#39;{&quot;content&quot;: {&quot;raw&quot;: &quot;[TEST] FAIL&quot;}}&#39; -H &#39;Content-Type: application/json&#39; &gt; /dev/null 2&gt;&amp;1;\n        echo [TEST] FAIL;\n        exit 1;\n    }\n    &#39;&#39;&#39;\n}</code></pre></div>\n<br>\n<p><span class=\"title__sub2\">2. Jacoco &#x26; SonarQube Analysis &#x26; Quality Gate</span></p>\n<ul>\n<li>테스트 성공 시 coverage 측정 및 정적분석 진행 후 Quality Gate 결과 확인</li>\n<li>Qulicy Gate 실패 시 PR comment &#x26; decline api 전송 후 파이프라인을 종료한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">stage (&#39;Jacoco &amp; SonarQube Analysis &amp; Quality Gate&#39;) {\n    withSonarQubeEnv(&#39;sonarqube&#39;) {\n        sh &quot;./gradlew jacocoTestReport sonarqube&quot;\n    }\n    \n    def qg = waitForQualityGate()\n    if (qg.status != &#39;OK&#39;) {\n        sh &#39;&#39;&#39;\n            curl -X POST -u &quot;$USER&quot; $COMMENT_URL -d &#39;{&quot;content&quot;: {&quot;raw&quot;: &quot;[QualityGate] FAIL&quot;}}&#39; -H &#39;Content-Type: application/json&#39; &gt; /dev/null 2&gt;&amp;1;\n            curl -X POST -u &quot;$USER&quot; $DECLINE_URL -d &#39;{&quot;content&quot;: {&quot;raw&quot;: &quot;[QualityGate] FAIL&quot;}}&#39; -H &#39;Content-Type: application/json&#39; &gt; /dev/null 2&gt;&amp;1;\n            echo [TEST] FAIL;\n            exit 1;\n        &#39;&#39;&#39;\n    } else {\n        sh &#39;&#39;&#39;\n            curl -X POST -u &quot;$USER&quot; $COMMENT_URL -d &#39;{&quot;content&quot;: {&quot;raw&quot;: &quot;[QualityGate] SUCCESS&quot;}}&#39; -H &#39;Content-Type: application/json&#39; &gt; /dev/null 2&gt;&amp;1;\n        &#39;&#39;&#39;\n    }\n}</code></pre></div>\n<br>\n<p><span class=\"title__sub2\">3. Approve PullRequest</span></p>\n<ul>\n<li>해당 PR에 대한 승인 API 전송 후 파이프라인 종료</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">stage (&#39;Approve PR&#39;) {\n    timeout(time: 1, unit: &#39;MINUTES&#39;) {\n        sh &#39;&#39;&#39;\n            curl -X POST -u &quot;$USER&quot; $APPROVE_URL;\n            echo Approve PullRequest;\n        &#39;&#39;&#39;\n    }\n}</code></pre></div>\n<hr>\n<p><a href=\"https://eunyoung-autocrypt.github.io/devHistoryBlog/works/posts/2021-01-18--001\">> [작업로그] CI/CD 구축 #1 - CI/CD 시나리오</a><br>\n<a href=\"https://eunyoung-autocrypt.github.io/devHistoryBlog/works/posts/2021-01-18--002\">> [작업로그] CI/CD 구축 #2 - Docker, Docker Compose 설치</a><br>\n<a href=\"https://eunyoung-autocrypt.github.io/devHistoryBlog/works/posts/2021-01-18--003\">> [작업로그] CI/CD 구축 #3 - BitBucket 설정 및 Jenkins 설치</a><br>\n<a href=\"https://eunyoung-autocrypt.github.io/devHistoryBlog/works/posts/2021-01-21--001\">> [작업로그] CI/CD 구축 #4 - Jenkins Item 등록 및 Pipeline 작성</a>  </p>","fields":{"tagSlugs":["/tags/ci-cd/","/tags/sonarqube/","/tags/pipeline/"],"slug":"/works/posts/2021-01-23--002"},"frontmatter":{"title":"[작업로그] CI/CD 구축 #5","tags":["ci/cd","sonarqube","pipeline"],"date":"2021-01-23","description":"sonarqube 설치 및 pipeline 작성"}}},"pageContext":{"slug":"/works/posts/2021-01-23--002"}},"staticQueryHashes":[]}