{"componentChunkName":"component---src-templates-post-template-jsx","path":"/history/posts/2021-01-25--001","result":{"data":{"site":{"siteMetadata":{"title":"Blog by Eunyoung","subtitle":"EY's 개발 히스토리 블로그","copyright":"© All rights reserved.","author":{"name":"EunYoung","twitter":"#"},"disqusShortname":"","url":"https://eunyoung-autocrypt.github.io"}},"markdownRemark":{"id":"7fed60ad-6082-5661-be10-233c28b75537","html":"<p><span class=\"title__sub1\"> #JPA에서 가장 중요한 2가지 </span></p>\n<ul>\n<li>객체와 관계형 데이터베이스 매핑</li>\n<li>영속 컨텍스트 (매커니즘)</li>\n</ul>\n<p><span class=\"title__sub1\"> #Entity Manager Factory 와 Entity Manager </span></p>\n<ul>\n<li>Factory에서 Entity Manager 생성</li>\n<li>Manager에서 DB Connection을 사용</li>\n</ul>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/56e36/001-01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABZ0lEQVQoz32T266CQAxF5/9/zTceNERB5SKgolwFNdqT1ZMSNZ4zSTPYoat7l9E9n09hXS4XadtWuq57C3JN02h8O+v7XuvhEM6Ah8NBTqeT1HUtVVXpfj6fxfM8mc1mMp/PpSxLzXFO8EzdVyAwuqKUrhamkPPdbifL5VKCIFAQUPJ/AikE8mmNHGqKohDf92W1Wk0O/gWiBoXEMAxyvV4lz3MJw1CL9/u9ws0F7zOGNyAJAiBFdMYOxVmWqT07tzGYG9Qb0JZjDiRRgiVg6/VaZ4U15sa5qadRHMeSpqnmEXC/33XHlQNyPB6nK2N22fkNcLPZaA5VuCCHABouFgttAIMGDvmEXQk6oYJGFCRJoqppYOOhAeMARJhDOA6AJQAR2+1WPwTWUUMj4FEUaY7gHVQxMtbtdpPH4/FrGYjNaBzH6V/zmsO+7cBQzhjs2kwfxR4YMl+Ulz8Di687SrGKC8Cv1+YHpnmPUHraz7AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"001 01\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/d9199/001-01.png\"\n        srcset=\"/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/8ff5a/001-01.png 240w,\n/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/e85cb/001-01.png 480w,\n/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/d9199/001-01.png 960w,\n/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/07a9c/001-01.png 1440w,\n/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/56e36/001-01.png 1750w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><span class=\"title__sub1\"> # 영속성 컨텍스트 </span></p>\n<ul>\n<li>엔티티를 영구저장하는 환경이라는 뜻</li>\n<li>논리적인 개념</li>\n<li>엔티티 매니저를 통해 영속성 컨텍스트에 접근</li>\n</ul>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/6cdcc3d9ecfda713e2edfeb4ecea79be/21482/001-02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 42.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABY0lEQVQoz31S2Y6CQBDk/7/Df/ADNPHF68ULVxnQACsoIIccg7XdrZDsxuwklelmuoua6jGezyc+Lf6ulMJ6vYZlWZhOp1gul8iyrD//W8/L6BKttext28pB0zQYjUYYDocYj8cYDAaCIAjknOs6cF8HIayqCpPJBPP5HNvtVtRsNhtRxApns5nkjMViIVitVjBNE77v/1LdKyyKAo/HQ8i7mJHnOdI0FXRxkiR9XpYloUJdNy9C/ZasdUvX1PhvcR0TZFlOZAX9vEZV10RWIwyvuEURjO/LBeZ+j+PxKObzIFhhHCe4swqKLWUjimNqCnE4fMG2ldTatt33REQWXm8wPM/HjrzY7UwhZm8CarzfU/HG9Tw4pzM1xJI7jiMESlk4n06SM7g+JisMni5PNE0z8qzsJ9jtrutKzNdk5Q3Vl+Tzy9+iv/4lCOVWxief/r6z7jnVb794cK9hlEJcEDjmuh8pGK0DBRd2iQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"001 02\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/6cdcc3d9ecfda713e2edfeb4ecea79be/d9199/001-02.png\"\n        srcset=\"/devHistoryBlog/static/6cdcc3d9ecfda713e2edfeb4ecea79be/8ff5a/001-02.png 240w,\n/devHistoryBlog/static/6cdcc3d9ecfda713e2edfeb4ecea79be/e85cb/001-02.png 480w,\n/devHistoryBlog/static/6cdcc3d9ecfda713e2edfeb4ecea79be/d9199/001-02.png 960w,\n/devHistoryBlog/static/6cdcc3d9ecfda713e2edfeb4ecea79be/21482/001-02.png 1350w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><span class=\"title__sub1\"> # 엔티티의 생명주기 </span></p>\n<ul>\n<li><span class=\"text-mark__red\">비영속 (new/transient) </span>\n— 영속성 컨텍스트와 전혀 관계가 없는 새로운 상태</li>\n<li><span class=\"text-mark__red\">영속 (managed)</span>\n— 영속성 컨텍스트에 관리되는 상태</li>\n<li><span class=\"text-mark__red\">준영속 (detached)</span>\n— 영속성 컨텍스트에 저장되었다가 분리된 상태</li>\n<li><span class=\"text-mark__red\">삭제 (removed)</span>\n— 삭제된 상태</li>\n</ul>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/36eca/001-03.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 71.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABRUlEQVQ4y4WU6Q6CQAyEef+Hg/+AIHhwCN7iBdR8TZasCtqk2V3aHWbagiMj1vf9sB6PRymKQsqylN1uJ13XveV8mvMLkMvb7VaiKJI4jhX4+XwOOWOgfwGxJEmUoR2fZGiCthsgJLquK0EQyPl81nNd11+g9n6UobHL5SKe56nk0+mk8quqGgV8Y3i73eR+v+tq6mYuYshN01SmymO7Y6TM53NlARCXqVuWZZLnuTaE82KxGGrJszAMv2v4eDx0NKgNgJyNsUc2QLPZTF/Mnlyzwooc/Hq9TnfZrst+v5fNZvP2ovV6raC+76uK1WqleaNdNmAkkGizYhYxVB0OB20aZSDO2fnFjiHGSUYuzPC2bXWMkEmcGAomJX+OwnK5HCQ3TaO1hjmy/34pNkNGCHZ03QDA6ufY/Ps5wAYgWDKfY0D2nRfNoEHrZum4TwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"001 03\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/d9199/001-03.png\"\n        srcset=\"/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/8ff5a/001-03.png 240w,\n/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/e85cb/001-03.png 480w,\n/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/d9199/001-03.png 960w,\n/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/07a9c/001-03.png 1440w,\n/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/36eca/001-03.png 1526w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// 비영속</span>\n<span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmember<span class=\"token punctuation\">.</span><span class=\"token function\">setId</span><span class=\"token punctuation\">(</span><span class=\"token number\">100L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmember<span class=\"token punctuation\">.</span><span class=\"token function\">setUserName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"member1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//영속</span>\nentityManager<span class=\"token punctuation\">.</span><span class=\"token function\">persist</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//회원 엔티티를 영속성 컨텍스트에서 분리, 준영속 상태</span>\nentityManager<span class=\"token punctuation\">.</span><span class=\"token function\">detach</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//객체를 삭제한 상태(DB에서 삭제)</span>\nentityManager<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><span class=\"title__sub1\"> # 영속성 컨텍스트의 이점 </span>\n<span class=\"title__sub2\">1) 1차 캐시</span></p>\n<ul>\n<li>1차 캐시는 한 트랜젝션에서만 허용된다.</li>\n<li>성능보다는 매커니즘에 이점에 있다.</li>\n<li>1차 캐시에서 조회\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/5a9d8c885d4d60229e8c8f111bfc1075/b5a09/001-04.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABRElEQVQoz22S646CQAxGef838ycxJqgo3rgoXlFAjfptTrMlmN0mzZR2OP2mM4F+7fP5mGPn81m73U7H41GHw0Fpmmq9Xmuz2XzFWZZZve/Bf0BAl8tFbduqrmtNJhONRiNFUaTpdNrF8/nc6jh79/u9Agf1gafTyVSy8Xa76fF46Pl86n6/q2ka+5kY9z3kDaie9RX2gTjHK8tSq9VKs9nMRpLn+V/g+/0WDozVZ1hVlSm5Xq/abrcGGY/HBgI+GAwUhqGKorDxdEDUJElig14sFlbkB7pTI08dIOoYPDlmGcexXQ5NvxS+Xi9zZsWKCn4ECHy5XFoD1LCi2JuS4zQdkOPRDQV05pgoGQ6HnSoUuHERNHajBpC8PRsSyHbpGJ2A8+ZQy2WgihhFODFO3mdO/HXLbjwbh/kx3R3Y/2ZlBAj5Adv49Wnk6xpZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"1차 캐시에서 조회\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/5a9d8c885d4d60229e8c8f111bfc1075/d9199/001-04.png\"\n        srcset=\"/devHistoryBlog/static/5a9d8c885d4d60229e8c8f111bfc1075/8ff5a/001-04.png 240w,\n/devHistoryBlog/static/5a9d8c885d4d60229e8c8f111bfc1075/e85cb/001-04.png 480w,\n/devHistoryBlog/static/5a9d8c885d4d60229e8c8f111bfc1075/d9199/001-04.png 960w,\n/devHistoryBlog/static/5a9d8c885d4d60229e8c8f111bfc1075/b5a09/001-04.png 1360w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>데이터베이스에서 조회\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/0486e/001-05.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 43.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABOElEQVQoz3WS646CQAyFef9Hk/CDhIiCIHgFQTFeEG9092tSg5tsk8MMncPpaQdHfuPxeMjhcJDj8ajY7Xay2Wxku91+wThN0+hK9H0vw3B4tG2rpOv1qvvlcinj8VjiOJYkSXSdTqcqcrvdlLff7/8XfD6fcj6f1SmCXdfJ/X6Xy+XycYWQiZEfCg7hQJrP5zKZTCSKIlmv1yqAS8BZnufqlFGcTqcvwb/h4CoMQ/E8T0ajkX5clqVkWaZiCCwWC3FdV89sNAi+Xi/tiNXcasu4RMQuBDHc8U7LNkfy1n5VVfoNxeq61gLAoRoJhJgj79woIqvVSs9wZheEAEUQwxkdFkWhUEFIQRAocTab6Sz5ZYBVhWw5HCLm+76kaaog93Foc4DMhdCq7XEI2BtwD4f1/X7rHzKMH3flpzxu8nkYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"데이터베이스에서 조회\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/d9199/001-05.png\"\n        srcset=\"/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/8ff5a/001-05.png 240w,\n/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/e85cb/001-05.png 480w,\n/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/d9199/001-05.png 960w,\n/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/07a9c/001-05.png 1440w,\n/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/29114/001-05.png 1920w,\n/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/0486e/001-05.png 2008w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n       </li>\n</ul>\n<p><span class=\"title__sub2\"> 2) 동일성 보장 </span></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Member</span> a <span class=\"token operator\">=</span> entityManager<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"member1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Member</span> b <span class=\"token operator\">=</span> entityManager<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"member1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">==</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 동일성 비교 true</span></code></pre></div>\n<p><span class=\"title__sub2\"> 3) 트랜잭션을 지원하는 쓰기 지연 (transactional write-behind) </span></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">EntityManager</span> entityManager <span class=\"token operator\">=</span> entityManagerFactory<span class=\"token punctuation\">.</span><span class=\"token function\">createEntityManager</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">EntityTransaction</span> transaction <span class=\"token operator\">=</span> entityManager<span class=\"token punctuation\">.</span><span class=\"token function\">getTransaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//엔티티 매니저는 데이터 변경 시 트랜잭션을 시작해야 한다.</span>\ntransaction<span class=\"token punctuation\">.</span><span class=\"token function\">begin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nentityManager<span class=\"token punctuation\">.</span><span class=\"token function\">persist</span><span class=\"token punctuation\">(</span>memberA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nentityManager<span class=\"token punctuation\">.</span><span class=\"token function\">persist</span><span class=\"token punctuation\">(</span>memberB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//여기까지 INSERT SQL을 데이터베이스에 보내지 않는다.</span>\n\n<span class=\"token comment\">//커밋하는 순간 데이터베이스에 INSERT SQL을 보낸다.</span>\ntransaction<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<ul>\n<li>entityManager.persist(memberA/B);\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/6a39605d2fbb606cce225caafc123e1f/c2d9c/001-06.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 115.41666666666669%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAABYlAAAWJQFJUiTwAAACaElEQVQ4y23Vh05rQQwE0Pz/x4EQSEDoCb2GllACyzt+mquN4ErOLesde8b2ZtT+XU9PT+329rY9PDyU3d/ft6urq3ZxcdEuLy/rmfU+s9ms3d3dtdfXVxDt+/u77iM/Fh8fH2sxdnx83HZ3d9vBwUHb399vW1tb7ejoqPwCyiTzCzAgHx8fbT6fV4aMM7MmO2svLy+DnZ2dVYAAspG0t7e3287OThuPxxUVvZOTkzLfTk9PB4qeAXkWjH9/jXxEj6F3eHhY95ubm3J+fn4uMO9sfX291gEKbN0l48Vi8Z+yl9BG7fr6usw7J2ajb8BkKBF0A2zN3qEoLAAcbbIZbXp6t3EymdQzRjK2L8GAFyCAvsqoahlGMyAA3AHQdWNjo+RJUd7f39vn5+dvwNAPVZUVHbBAsgA+nU4LUICVogSQJjb3veg9Wrm+vr6K3tvbW1sulyVFAIe2iYZpg2QbXfsK84n4wEjS9+HKpNAHrVjGrjffFITxQRuLFUA0AIZupoE+Gn5vb69GTyEAWos8mZgVQA/STgECKgha1tDUPqhGklBOYw8aEhgdDjQS8fz8vCRwB0Q/gaJxZpx/X5TK0Ebj5DRZW1srfaIZQHc+gOiGPhmshUE6oDL0IxrKIqa/0EHdd1nrQdStCywzk2Mv2ql8FYVzmrqfUVTT8Jy9K5RzEXg/ywBrllPlAMqKk00OWNWNlikM2pubmyWPPTAElOkvwFiouAMUIEeaQM5PIxgNh9ELYA/WH2c5SdCyGahTKJa/gKEoAdQ+ORB6y+Gg0hFetgrn25//KaKqXkbqL0M74xYD2De26wc0GM9kCGT9yQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"001 06\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/6a39605d2fbb606cce225caafc123e1f/d9199/001-06.png\"\n        srcset=\"/devHistoryBlog/static/6a39605d2fbb606cce225caafc123e1f/8ff5a/001-06.png 240w,\n/devHistoryBlog/static/6a39605d2fbb606cce225caafc123e1f/e85cb/001-06.png 480w,\n/devHistoryBlog/static/6a39605d2fbb606cce225caafc123e1f/d9199/001-06.png 960w,\n/devHistoryBlog/static/6a39605d2fbb606cce225caafc123e1f/c2d9c/001-06.png 1326w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>transaction.commit();\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/7ef4c/001-07.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 57.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABa0lEQVQoz3WTDauCYAyF/f+/LDAIAs0IjLTMLPvULAgXz+BIeLkvDOfes7OzOYPj8Wjn89kul4vh7/d7t8PhMPjEuQdX17V1XWecvu//WAD4+Xw6CJIkSWyxWNh6vbbVamXL5dKqqrL3++2Yx+PhJsLxCagKsGkaJ369Xp5M0vV6tfv97k+pw8ByPp+P49u29RxXiBJUEgQIET4xkmkVEyldcM8Bm2WZRVHk9wgK5vO5t0YyAcDY7XZzdcRFfjqdBtWoowAzZkxSHuBAoNkA5h1V+BQBSEwFttutKyuKwqbTqcVx7OROSHUcWkHBZrNxH6OAlGKaKzHNUEQU9JapRqXZbGZ5nrsfhqFNJhNvRzNVAsRlWQ6joDCk6ibY7XYehEhDT9PUjTsR/ratD4DPl5V6XxsUaokB8mT3mAuKAUImQtrV2oyPrw3yUcbyAmaOxPSHaOkxdm682L82KMRoD0V6V2xsxCny35/yBaawj/vTyATKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"001 07\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/d9199/001-07.png\"\n        srcset=\"/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/8ff5a/001-07.png 240w,\n/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/e85cb/001-07.png 480w,\n/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/d9199/001-07.png 960w,\n/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/07a9c/001-07.png 1440w,\n/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/7ef4c/001-07.png 1748w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n</ul>\n<p><span class=\"title__sub2\"> 4) 변경 감지 (Dirty Checking) </span></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">EntityManager</span> entityManager <span class=\"token operator\">=</span> entityManagerFactory<span class=\"token punctuation\">.</span><span class=\"token function\">createEntityManager</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">EntityTransaction</span> transaction <span class=\"token operator\">=</span> entityManager<span class=\"token punctuation\">.</span><span class=\"token function\">getTransaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//영속 엔티티 조회</span>\n<span class=\"token class-name\">Member</span> memberA <span class=\"token operator\">=</span> entityManager<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"memberA\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//영속 엔티티 데이터 수정</span>\nmemberA<span class=\"token punctuation\">.</span><span class=\"token function\">setUsername</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hi\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmemberA<span class=\"token punctuation\">.</span><span class=\"token function\">setAge</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//커밋하는 순간 데이터베이스에 UPDATE SQL을 보낸다.</span>\ntransaction<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/37c35/001-08.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 60.83333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABiElEQVQoz22SCa+CQAyE+f//DBMSojFR8UARwRPEA5Sj5mtS4/O5ScPu0s5MZ+tcr1c5HA5yOp0kyzJZr9cynU5lPp9rzGYzCcNQjsej/ieP/LZthdV1nXwu53w+S57nUlWVPB4P2W63ChBFkYIvFgs9F0Whcb/fFbBpmt+At9tNmTebjaxWK0mSRPco4UsxJCgFME1T2e/3fwA/w6GQZJTEcayBOoDZUwzRcrnUOwggsvVPIW0FQaB+4WdZltoWewJVgEIMIF6aBYCzsIpOqXUoog0eAqXj8Vgmk4mC4C2JFBAQAQQwilFKLcAQUeNcLhf1kLB2SUaFgVLIPSoRYC8O2GAw0DweFzJVaIyj0Uh2u52eXddVpRR5nqdnHsfGDBC6wl/sQhhE75bxEjAU2SyiEtXD4VD6/b4SmUL8AuT5fOrDoA5b3oA2DjbcPBSe0qrv+9Lr9RQcTwG0wf5e6iFgSKfAxoIxsrnky/mz5bquf88hCQDQLgUAQMCeMPW25z+5Nn/fc/gCIwGImSU8AqIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"001 08\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/d9199/001-08.png\"\n        srcset=\"/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/8ff5a/001-08.png 240w,\n/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/e85cb/001-08.png 480w,\n/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/d9199/001-08.png 960w,\n/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/07a9c/001-08.png 1440w,\n/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/37c35/001-08.png 1810w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><span class=\"title__sub2\"> 5) 지연 로딩 (Lazy Loading) </span>  </p>\n<ul>\n<li>추후 뒤에서 다시 정리</li>\n</ul>\n<p><span class=\"title__sub1\"> # 플러시 </span></p>\n<ul>\n<li>영속성 컨텍스트의 변경 내용을 데이터베이스에 반영</li>\n<li>플러시가 발생되면 1차 캐시에 있는 정보가 사라지는게 아니라 쓰기 지연 SQL 저장소에 있는 SQL이 실행된다.</li>\n<li>JPQL을 사용하면 자동으로 flush가 날라가고 해당 쿼리가 실행된다.</li>\n<li>트랜잭션이라는 작업 단위가 중요! (커밋 직전에만 동기화 하면 된다.)</li>\n</ul>\n<br>","fields":{"tagSlugs":["/tags/jpa/"],"slug":"/history/posts/2021-01-25--001"},"frontmatter":{"title":"영속성 관리 - 내부 동작 방식","tags":["jpa"],"date":"2021-01-25","description":"자바 ORM 표준 JPA 프로그래밍 강의 복습"}}},"pageContext":{"slug":"/history/posts/2021-01-25--001"}},"staticQueryHashes":[]}