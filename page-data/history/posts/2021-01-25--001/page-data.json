{"componentChunkName":"component---src-templates-post-template-jsx","path":"/history/posts/2021-01-25--001","result":{"data":{"site":{"siteMetadata":{"title":"Blog by Eunyoung","subtitle":"EY's 개발 히스토리 블로그","copyright":"© All rights reserved.","author":{"name":"EunYoung","twitter":"#"},"disqusShortname":"","url":"https://eunyoung-autocrypt.github.io"}},"markdownRemark":{"id":"4c49fbf6-7885-5450-8bdb-8a61481902b6","html":"<p><span class=\"title__sub1\"> #JPA에서 가장 중요한 2가지 </span></p>\n<ul>\n<li>객체와 관계형 데이터베이스 매핑</li>\n<li>영속 컨텍스트 (매커니즘)</li>\n</ul>\n<p><span class=\"title__sub1\"> #Entity Manager Factory 와 Entity Manager </span></p>\n<ul>\n<li>Factory에서 Entity Manager 생성</li>\n<li>Manager에서 DB Connection을 사용</li>\n</ul>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/56e36/001-01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABXklEQVQoz22SWa+CQAyF+f+/jVcfRJRFQAVBEWRJlN58venEjeSkQ5fT0854y7II3/1+l7Ztpes6ud1uDpfLReq6lqZpNGbx1zw+eIBnhFZEAsRmV6uV+L6vtqoqbXC9Xh3KsvxNSBCSYRhU7SeIHw4HWa/XEgSBnE4np/4nIUEUUdz3vYONRhyS7XarMIVfhM/n80shGMdR5nlWkjAMlZCRaUjMGp/P53dCEtmDyYcYkqIoJM9zJWO3wMa3PM5GaJ+HKjoDiEhI01SJoihSYnyMjnKa7/d7ybLMXRKT0ADFHskk2c4YB0zTpP/H41F2u5367OZpYn5uP45jVU0DjwRIcWDpRDJFm81G1RCzfVHEBLYSYDXkvY2MUizj0DVJEi2kADUQ4ePMOiBgZL7H4/F/KTjZHQpYMvtgV/ZkODP+q6UhYA32bNyl2AElPFq6886wdv4E6piAlWBfn80fWtuOk5/+MF0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"001 01\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/d9199/001-01.png\"\n        srcset=\"/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/8ff5a/001-01.png 240w,\n/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/e85cb/001-01.png 480w,\n/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/d9199/001-01.png 960w,\n/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/07a9c/001-01.png 1440w,\n/devHistoryBlog/static/796220b97cd1d89e69e4bab3f897de77/56e36/001-01.png 1750w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><span class=\"title__sub1\"> # 영속성 컨텍스트 </span></p>\n<ul>\n<li>엔티티를 영구저장하는 환경이라는 뜻</li>\n<li>논리적인 개념</li>\n<li>엔티티 매니저를 통해 영속성 컨텍스트에 접근</li>\n</ul>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/6cdcc3d9ecfda713e2edfeb4ecea79be/21482/001-02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 42.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABa0lEQVQoz3VSy46CQBDk/7/Di3/g1YPxYGI0wReIaFxYQBd5yRtrp3oD2YNO0mFm6K7qqh7t9Xrh3WrbFsfjEbquw7IszOdzLJdLFEXxNr/H0fpD0zTouk6AeGbhdDrFZDLBbDbDaDTCeDxGGIYDIYM1zO9DAPM8lyJ2sN/vsVgssNvtsF6vsd1uh3sG96vVCpuNDtM04fs+ns/n0OXQITuqqgp1XaMsyyFIxoI+0jRDHCfy5b8+j3UC+Nc2Jbci+9NicifEJbKM4LlqoBagum5wu90RRTE0z/NxOBhi/Ol0wvl8FuZHFCFJUunKsmzESYIgCGRQtm0Puazjl96G4QOa++3hYBgwlB+GYYp39/sP0ixTslK4rovr1RGZWZaq/RWXy0XCcRw5O86XkCeKVEnuRCo9KctK5HFyXLz3PE/2BM+Vz7xjXp4XyOipIqYFvh8IqPbpPf1/n+KfIqFX9IzDIyiHQU/7gTLvF9rZrPl5EYG3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"001 02\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/6cdcc3d9ecfda713e2edfeb4ecea79be/d9199/001-02.png\"\n        srcset=\"/devHistoryBlog/static/6cdcc3d9ecfda713e2edfeb4ecea79be/8ff5a/001-02.png 240w,\n/devHistoryBlog/static/6cdcc3d9ecfda713e2edfeb4ecea79be/e85cb/001-02.png 480w,\n/devHistoryBlog/static/6cdcc3d9ecfda713e2edfeb4ecea79be/d9199/001-02.png 960w,\n/devHistoryBlog/static/6cdcc3d9ecfda713e2edfeb4ecea79be/21482/001-02.png 1350w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><span class=\"title__sub1\"> # 엔티티의 생명주기 </span></p>\n<ul>\n<li><span class=\"text-mark__red\">비영속 (new/transient) </span>\n— 영속성 컨텍스트와 전혀 관계가 없는 새로운 상태</li>\n<li><span class=\"text-mark__red\">영속 (managed)</span>\n— 영속성 컨텍스트에 관리되는 상태</li>\n<li><span class=\"text-mark__red\">준영속 (detached)</span>\n— 영속성 컨텍스트에 저장되었다가 분리된 상태</li>\n<li><span class=\"text-mark__red\">삭제 (removed)</span>\n— 삭제된 상태</li>\n</ul>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/36eca/001-03.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 71.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABS0lEQVQ4y42T666CMBCEef/H8ievgFyCggqigKJcXfNtUuOpB3STTZtCZ2dmt478E4/HQ5O43W5yPp+lLEtpmuZ1blY7nDlAYpomyfNcfN+XMAxlt9vJOI4fRb8C2gyiKJL9fq8FlsAU0Hy0k0Dmer1WhpfLRbquUwts0Pe9s8QM71arlYLi33a7VdlfAfGFg2EY9PB+v2uanw+HwwvILmorc6gME6oj63Q6ied5mjSkKAr1kAT4er0qUJIkeufDQ5jgFQwANB4RpgBgQRDoP/hZVZXaQKOIvu9VHUr/SJ4bCViaywSqsizTs81moytsIebY7X8Hq+taZadpqrYgmZVgD6jrunI8HrUoihbHBvmAchHpSIUdgcS2bRWEorDE358GmwbAwPhFkTiOlflPc/j+9PAFn4xEGBm/AbdHaPEts5ou85YBnCNg8gmNlkHxroyDYwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"001 03\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/d9199/001-03.png\"\n        srcset=\"/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/8ff5a/001-03.png 240w,\n/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/e85cb/001-03.png 480w,\n/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/d9199/001-03.png 960w,\n/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/07a9c/001-03.png 1440w,\n/devHistoryBlog/static/98c14163f5b2716eb8e8d530b04856f8/36eca/001-03.png 1526w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// 비영속</span>\n<span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmember<span class=\"token punctuation\">.</span><span class=\"token function\">setId</span><span class=\"token punctuation\">(</span><span class=\"token number\">100L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmember<span class=\"token punctuation\">.</span><span class=\"token function\">setUserName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"member1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//영속</span>\nentityManager<span class=\"token punctuation\">.</span><span class=\"token function\">persist</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//회원 엔티티를 영속성 컨텍스트에서 분리, 준영속 상태</span>\nentityManager<span class=\"token punctuation\">.</span><span class=\"token function\">detach</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//객체를 삭제한 상태(DB에서 삭제)</span>\nentityManager<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><span class=\"title__sub1\"> # 영속성 컨텍스트의 이점 </span>\n<span class=\"title__sub2\">1) 1차 캐시</span></p>\n<ul>\n<li>1차 캐시는 한 트랜젝션에서만 허용된다.</li>\n<li>성능보다는 매커니즘에 이점에 있다.</li>\n<li>1차 캐시에서 조회\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/5a9d8c885d4d60229e8c8f111bfc1075/b5a09/001-04.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABRElEQVQoz22S646CQAxGef838ycxJqgo3rgoXlFAjfptTrMlmN0mzZR2OP2mM4F+7fP5mGPn81m73U7H41GHw0Fpmmq9Xmuz2XzFWZZZve/Bf0BAl8tFbduqrmtNJhONRiNFUaTpdNrF8/nc6jh79/u9Agf1gafTyVSy8Xa76fF46Pl86n6/q2ka+5kY9z3kDaie9RX2gTjHK8tSq9VKs9nMRpLn+V/g+/0WDozVZ1hVlSm5Xq/abrcGGY/HBgI+GAwUhqGKorDxdEDUJElig14sFlbkB7pTI08dIOoYPDlmGcexXQ5NvxS+Xi9zZsWKCn4ECHy5XFoD1LCi2JuS4zQdkOPRDQV05pgoGQ6HnSoUuHERNHajBpC8PRsSyHbpGJ2A8+ZQy2WgihhFODFO3mdO/HXLbjwbh/kx3R3Y/2ZlBAj5Adv49Wnk6xpZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"1차 캐시에서 조회\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/5a9d8c885d4d60229e8c8f111bfc1075/d9199/001-04.png\"\n        srcset=\"/devHistoryBlog/static/5a9d8c885d4d60229e8c8f111bfc1075/8ff5a/001-04.png 240w,\n/devHistoryBlog/static/5a9d8c885d4d60229e8c8f111bfc1075/e85cb/001-04.png 480w,\n/devHistoryBlog/static/5a9d8c885d4d60229e8c8f111bfc1075/d9199/001-04.png 960w,\n/devHistoryBlog/static/5a9d8c885d4d60229e8c8f111bfc1075/b5a09/001-04.png 1360w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>데이터베이스에서 조회\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/0486e/001-05.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 43.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABQ0lEQVQoz22S546DMBCE/f6vBv9CCiWVlkAqEp2wuW8lR6fTWRps7J3xzIKRnzHPszyfT3k8Hjpfr1fJskzyPP+Cd/Y5B7fbTd7vt1i+HYbHOI5aUNe1NE0jZVnKarWSIAhku90qNpuNXC4XadtWaxCH968go6oqGYZBCYA1F+D6fr+rSNd1ugf+CloYiMRZr9cShqEcDgeNRMzj8Sin00n2+726pI4z63Capq8z69KwgOi6rjiOI77vS1EUkiSJRn69XhqV8yiKtB0kQBAzuGZm0FNj1c/ns8ajl9YZJFqBa9zvdjsV7Ptez1hTiwF4wGAfIQRxQ38ohIwQRbjFHXvA1uOO2PSYGvYNJM/ztJDblsulHtIvhCkmMu+AC+jjYrFQ1/QWt4gxG24gAjdCIKolp2mq4oA14GMxx3GsPPi/f5sPvGGnXVmwQEcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"데이터베이스에서 조회\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/d9199/001-05.png\"\n        srcset=\"/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/8ff5a/001-05.png 240w,\n/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/e85cb/001-05.png 480w,\n/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/d9199/001-05.png 960w,\n/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/07a9c/001-05.png 1440w,\n/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/29114/001-05.png 1920w,\n/devHistoryBlog/static/89ad050cd24740b61c36a3eb4c014aef/0486e/001-05.png 2008w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n       </li>\n</ul>\n<p><span class=\"title__sub2\"> 2) 동일성 보장 </span></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Member</span> a <span class=\"token operator\">=</span> entityManager<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"member1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Member</span> b <span class=\"token operator\">=</span> entityManager<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"member1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">==</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 동일성 비교 true</span></code></pre></div>\n<p><span class=\"title__sub2\"> 3) 트랜잭션을 지원하는 쓰기 지연 (transactional write-behind) </span></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">EntityManager</span> entityManager <span class=\"token operator\">=</span> entityManagerFactory<span class=\"token punctuation\">.</span><span class=\"token function\">createEntityManager</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">EntityTransaction</span> transaction <span class=\"token operator\">=</span> entityManager<span class=\"token punctuation\">.</span><span class=\"token function\">getTransaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//엔티티 매니저는 데이터 변경 시 트랜잭션을 시작해야 한다.</span>\ntransaction<span class=\"token punctuation\">.</span><span class=\"token function\">begin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nentityManager<span class=\"token punctuation\">.</span><span class=\"token function\">persist</span><span class=\"token punctuation\">(</span>memberA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nentityManager<span class=\"token punctuation\">.</span><span class=\"token function\">persist</span><span class=\"token punctuation\">(</span>memberB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//여기까지 INSERT SQL을 데이터베이스에 보내지 않는다.</span>\n\n<span class=\"token comment\">//커밋하는 순간 데이터베이스에 INSERT SQL을 보낸다.</span>\ntransaction<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<ul>\n<li>entityManager.persist(memberA/B);\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/6a39605d2fbb606cce225caafc123e1f/c2d9c/001-06.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 115.41666666666669%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAABYlAAAWJQFJUiTwAAACbUlEQVQ4y23ViU6qQQwFYN7/4dS4i4obCooLrqARx/s1OeRHLkmdzkx72p52fnvt3+/5+bk9PDy06XTanp6e2uPjYxuPx+3m5qaNRqPSyf39fdmQ+Ly/v4NoPz8/tfb8AcLAZeT8/Lz1+/02GAza6elp293drTN2CUpeX1/XAd/e3grk8/OzVpEZc04gZx8fH0tb6/X1dXt5eVkCkt7d3V1FPzg4aIeHh8tyLy8vl1kOh8MqczKZtKurq9oLIJjz7q8nZc4k5RHOjGUSMLKxsdHOzs4KUGD3MoOjgirZJtwxjLP9bDYrUdrt7W0F1Sg+aQxg9pq21hTOMlLW8fFxlc1JqaGCDhhdAgGno6sAMwbJUoCMCuIBALayPTo6atvb2wWapnx9fbXv7+91wHQxpdJFB8xOWRcXF1UBLgO4bEoAXSCVJFO68zgtFosqz3jR0+mVsbFRe3cM8mIiMiSI1xgrey+pO4crLwXZylKKtfvkIs6AkNiiZQUQkTJKqVZlnZyctP39/eo00QiAOJYVIHb2K4CUGKQJQPNm3eWFoMbeHV2mXcDikLOLDLSoykknjQv+EiQcA+42Zdll3G1tbbW9vb22ublZIEpDvhWY7Di6Q4X37c4I5WuDusowJc/n8yqDk4HVhNCgrHRb5gLLUtBQkM5XUxhnqGMgOgC6c8b2vkpAcycJOvt6y+lyAHHlwivQWR3GMS4BAVbyzs5Occ3PkEuK/xpgJCMhY4D5ZMlIICLI2tP7W3JXnHFQEr6USMdxvp1piiyrKclQU9KErqAAiGmQIZEtcfbf/ynpnvH4K/n+5TPGLmf0vy/lF+jvzvutQUbvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"001 06\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/6a39605d2fbb606cce225caafc123e1f/d9199/001-06.png\"\n        srcset=\"/devHistoryBlog/static/6a39605d2fbb606cce225caafc123e1f/8ff5a/001-06.png 240w,\n/devHistoryBlog/static/6a39605d2fbb606cce225caafc123e1f/e85cb/001-06.png 480w,\n/devHistoryBlog/static/6a39605d2fbb606cce225caafc123e1f/d9199/001-06.png 960w,\n/devHistoryBlog/static/6a39605d2fbb606cce225caafc123e1f/c2d9c/001-06.png 1326w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>transaction.commit();\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/7ef4c/001-07.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 57.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABdklEQVQoz3WT646CQAyFef8nM5rwh8R4iSh4QRQveEUkdPOdpIa4u5OczNBpT087Jdjv93Y6nYTdbmfr9VrYbre22WyErs/hcLCqqozVtu0vBDg/Hg97Pp8iGY1GwmKxsOl0apPJxIqiEAk+l8vFbreb/beC4/EoR5wgfr1eVte1As/ns12vV+34oQ5y/Fjv91tnYomTwtlsppLu97suIOCMDRJAqU6a57kEsEg6n89tOBzqHnsQRZFBShDZIANlWSoARQB1AD/sVEEC+j0ej3UmPsDJZeMIEYQEulru2D3BarUSeLB+v68+fwgpjUAehHOSJDoD7JA4+PZErKZpRORVqWQyITsMw8/I9Ho9GwwGInV1AAVUgB2lCKCnJMHOJIiQ+cuyTBc4x3GsZlOSE/pOIPA2+eNwp7FZLpciJJiXYmcOeTmSEeQgCB8fGx/u7jlAEX1APpkphTK8LPrioKTuYH//JR+FADVpmpp/u+0vdH+97/UD1muQFkv0nd8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"001 07\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/d9199/001-07.png\"\n        srcset=\"/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/8ff5a/001-07.png 240w,\n/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/e85cb/001-07.png 480w,\n/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/d9199/001-07.png 960w,\n/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/07a9c/001-07.png 1440w,\n/devHistoryBlog/static/79ccf2f419dc41d24a05841bf2285535/7ef4c/001-07.png 1748w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n</ul>\n<p><span class=\"title__sub2\"> 4) 변경 감지 (Dirty Checking) </span></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">EntityManager</span> entityManager <span class=\"token operator\">=</span> entityManagerFactory<span class=\"token punctuation\">.</span><span class=\"token function\">createEntityManager</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">EntityTransaction</span> transaction <span class=\"token operator\">=</span> entityManager<span class=\"token punctuation\">.</span><span class=\"token function\">getTransaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//영속 엔티티 조회</span>\n<span class=\"token class-name\">Member</span> memberA <span class=\"token operator\">=</span> entityManager<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"memberA\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//영속 엔티티 데이터 수정</span>\nmemberA<span class=\"token punctuation\">.</span><span class=\"token function\">setUsername</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hi\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmemberA<span class=\"token punctuation\">.</span><span class=\"token function\">setAge</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//커밋하는 순간 데이터베이스에 UPDATE SQL을 보낸다.</span>\ntransaction<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/37c35/001-08.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 960px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 60.83333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABfElEQVQoz3WTWZOCQAyE+f8/jBcKXjyxVBTxxAsPUK5sfdkKD7s6VanMDJlOd0edPM/ler3K7XbTOB6Pst/v5XA4aLBP01SyLNPvZKJtW2FZtuUAdj6f5fF4yPP5lMViIYPBQMIwlMlkIsPhULMBUUejpmk+A97vdy0EFCZka3A6nZQ9AOv1ulPAPYCA/Q1lGMexTKdTmc1mGjBarVYyn89V8nK51D0NAd9utx2jfwwpHo/HCvB+v6UsSw3k4y/sAQCMxrAjv14vQR0LtkVRSFVVvwyRMxqNlIUxBeByuSgojQhrkCSJsiZztlqygy8c6LzZbCSKIo3dbqf+8QDfKOaMt+YjdvT7fbHBUqtD4QOSmSx7gF3XVbZ4FgSB+L6voAZImBoykmmigHiEBLJZQBF37Hu9ngasbfq8owE24Cd3+N4B8pFLqBtburOHoed5ytwAv61OMmx4gJ/mJdOkmQ0L+TACsK7rz79DmxpyeIxEgjvbW9CIoPbbX+8HY1GJBftc2/EAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"001 08\"\n        title=\"\"\n        src=\"/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/d9199/001-08.png\"\n        srcset=\"/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/8ff5a/001-08.png 240w,\n/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/e85cb/001-08.png 480w,\n/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/d9199/001-08.png 960w,\n/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/07a9c/001-08.png 1440w,\n/devHistoryBlog/static/f948d2a79296874c2fcb74192171d7ed/37c35/001-08.png 1810w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><span class=\"title__sub2\"> 5) 지연 로딩 (Lazy Loading) </span>  </p>\n<ul>\n<li>추후 뒤에서 다시 정리</li>\n</ul>\n<p><span class=\"title__sub1\"> # 플러시 </span></p>\n<ul>\n<li>영속성 컨텍스트의 변경 내용을 데이터베이스에 반영</li>\n<li>플러시가 발생되면 1차 캐시에 있는 정보가 사라지는게 아니라 쓰기 지연 SQL 저장소에 있는 SQL이 실행된다.</li>\n<li>JPQL을 사용하면 자동으로 flush가 날라가고 해당 쿼리가 실행된다.</li>\n<li>트랜잭션이라는 작업 단위가 중요! (커밋 직전에만 동기화 하면 된다.)</li>\n</ul>\n<br>","fields":{"tagSlugs":["/tags/jpa/"],"slug":"/history/posts/2021-01-25--001"},"frontmatter":{"title":"영속성 관리 - 내부 동작 방식","tags":["jpa"],"date":"2021-01-25","description":"자바 ORM 표준 JPA 프로그래밍 강의 복습"}}},"pageContext":{"slug":"/history/posts/2021-01-25--001"}},"staticQueryHashes":[]}